/* ═══════════════════════════════════════════════════════════
   PAGE FLIP ANIMATION SYSTEM
   CSS 3D transforms for hardware-accelerated page curl
   ═══════════════════════════════════════════════════════════ */

/* ────────────────────────────────────────────────────────────
   FLIP CONTAINER
   Current page sits in normal flow; only animating layers
   are position:absolute so the container never collapses.
   ──────────────────────────────────────────────────────────── */
.page-flip-container {
    position: relative;
    width: 100%;
    min-height: 100%;
    perspective: 1200px;
    perspective-origin: center center;
}

/* ────────────────────────────────────────────────────────────
   CURRENT PAGE — in normal flow so it sizes the container
   ──────────────────────────────────────────────────────────── */
.page-flip-current {
    position: relative;
    width: 100%;
    z-index: 2;
    transform-origin: left center;
    transform-style: preserve-3d;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
}

/* ────────────────────────────────────────────────────────────
   ANIMATING LAYERS — absolutely positioned over the current
   ──────────────────────────────────────────────────────────── */
.page-flip-layer {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    min-height: 100%;
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
    transform-style: preserve-3d;
    overflow-y: auto;
    overflow-x: hidden;
    -webkit-overflow-scrolling: touch;
    background: var(--bg-primary, #fff);
}

.page-flip-layer--next {
    z-index: 1;
}

.page-flip-layer--prev {
    z-index: 3;
    transform-origin: right center;
}

/* ────────────────────────────────────────────────────────────
   FLIP FORWARD ANIMATION
   Current page rotates away, next page revealed underneath
   ──────────────────────────────────────────────────────────── */
.page-flip-current--flipping-forward {
    z-index: 3;
    animation: flipForward var(--flip-duration, 400ms) cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
    will-change: transform;
}

@keyframes flipForward {
    0% {
        transform: rotateY(0deg);
        box-shadow: 0 0 0 rgba(0, 0, 0, 0);
    }

    30% {
        box-shadow: -8px 0 20px rgba(0, 0, 0, 0.15);
    }

    100% {
        transform: rotateY(-180deg);
        box-shadow: 8px 0 20px rgba(0, 0, 0, 0.05);
    }
}

/* ────────────────────────────────────────────────────────────
   FLIP BACKWARD ANIMATION
   Previous page flips in from the left
   ──────────────────────────────────────────────────────────── */
.page-flip-layer--flipping-backward {
    animation: flipBackward var(--flip-duration, 400ms) cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
    will-change: transform;
}

@keyframes flipBackward {
    0% {
        transform: rotateY(-180deg);
        box-shadow: 8px 0 20px rgba(0, 0, 0, 0.05);
    }

    70% {
        box-shadow: -8px 0 20px rgba(0, 0, 0, 0.15);
    }

    100% {
        transform: rotateY(0deg);
        box-shadow: 0 0 0 rgba(0, 0, 0, 0);
    }
}

/* ────────────────────────────────────────────────────────────
   SHADOW OVERLAY (canvas-rendered gradient)
   ──────────────────────────────────────────────────────────── */
.page-flip-shadow {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 4;
    pointer-events: none;
    opacity: 0;
    transition: opacity 100ms ease;
}

.page-flip-shadow--active {
    opacity: 1;
}

/* ────────────────────────────────────────────────────────────
   REDUCED MOTION
   ──────────────────────────────────────────────────────────── */
@media (prefers-reduced-motion: reduce) {

    .page-flip-current--flipping-forward,
    .page-flip-layer--flipping-backward {
        animation-duration: 0ms !important;
    }
}